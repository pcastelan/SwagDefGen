<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<title>Swagger Generator</title>
		<script src="swaggerGen.js" type="text/javascript"></script>
		<script>
			function init() {
				//Handle tabs inside JSON textarea
				let txtArea = document.getElementById('JSON');
				txtArea.onkeydown = function(e){
					if(e.keyCode==9 || e.which==9){
					    e.preventDefault();
					    let s = this.selectionStart;
					    this.value = this.value.substring(0,this.selectionStart) + "\t" + this.value.substring(this.selectionEnd);
					    this.selectionEnd = s+1; 
					}
				}
			};
		</script>
		<style>
			body{
				font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
				font-size: 14px;
			}
			textarea{
				display: inline-block;
				margin: 10px;
				font:12px Menlo, Monaco, Consolas, monospace;
				line-height: 1.3;
				resize: vertical;
			}

			button{
				display: inline-block;
			}
			.row{
				display: flex;
				width: 100%;
				align-items: stretch;
				min-height: 400px;
			}
			.row textarea{
				flex-grow: 1;
				padding: 10px;
			}
			.btn-convert{
				width: 90%;
				margin: 20px auto;
				background: #0c8c4a;
				padding: 10px;
				display: block;
				border-radius: 2px;
				color: white;
				border:0;
			}
			.btn-convert:hover{
				background: #0a6b39;
			}
			.content-wrapper{
				max-width: 1400px;
				margin: 0 auto;
			}
		</style>
	</head>
	<body onload="init();">
		<div class="content-wrapper">

			<h1>Swagger Definition Objects Generator</h1>
			<p>Add your JSON mock to generate Swagger definition objects.</p>
			<div class="row">
				<textarea id="JSON"  placeholder="Type your JSON">
{
	"numbersMock": {
		"smallInt": -20,
		"bigInt": 2147483647,
		"unsafeInt": 9999999999999999,
		"notInt": 12.2
	},
	"stringsMock": {
		"stringTest": "Hello World",
		"isoDate": "1999-12-31",
		"isoDateTime": "1999-12-31T23:59:59Z"
	},
	"objectsMock": {
		"child": {"child": true},
		"childList": [{"child": true}],
		"childMatrix": [[{"child": true}]],
		"nullable": null
	}
}
		</textarea>
				<textarea readonly id="Swagger" placeholder="Here is your Swagger"></textarea>
			</div>
		  <button type="button" onclick="convert()" class="btn-convert">Convert</button>
			
			<ul style="list-style: none;padding-left: 0;">
				
				<li>Add values as examples: <input type="checkbox" id="requestExamples"></li>
				<li>Convert integer values to number: <input type="checkbox" id="noInt"></li>
				<li>Convert null values to:
					<select id="nullType">
						  <option value="string" selected="">String</option>
						  <option value="number">Number</option>
						<option value="integer">Integer</option>
						<option value="boolean">Boolean</option>
					</select>
				</li>
				<li>Output as YAML: <input type="checkbox" id="yamlOut"></li>	
			</ul>

			<p style="font-size: 12px;margin-top: 10px;text-align: right;">Feel like collaborating? Clone the repository at <a target="_blank" href="https://github.com/Roger13/SwaggerGenerator">GitHub</a></p>
		</div>
	

	</body>
	<script>
		const options = ['requestExamples', 'noInt', 'nullType', 'yamlOut']
		options.forEach(
			option => document.getElementById(option).addEventListener("change", (event) => {
				if (event.target.type === 'checkbox' ) {
					if (!event.target.checked) {
						return localStorage.removeItem(option)
					}
					return localStorage.setItem(option, 1)
				}
				return localStorage.setItem(option, event.target.value);		
			})
		)
		options.forEach(
			option => {
				const value = localStorage.getItem(option)
				const input = document.getElementById(option)

				if (value === null || !input) return
				if (input.type === 'checkbox') return input.checked = true 
				return input.value = value
			}
		)
	</script>
</html>
